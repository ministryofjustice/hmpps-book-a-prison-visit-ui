{% extends "partials/layout.njk" %}
{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/warning-text/macro.njk" import govukWarningText %}
{% from "govuk/components/button/macro.njk" import govukButton %}

{% set activeLink = 'visitors-link' %}
{% set pageTitle = "Visitors" %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      <h1 class="govuk-heading-l">{{ pageTitle }}</h1>

      <h2 class="govuk-heading-m">
        <span data-test="prisoner-name">{{ prisoner | prisonerNameFirstLast }}</span>’s visitors
      </h2>

      {% if visitorsTableRows | length %}
        <h3 class="govuk-heading-s govuk-!-margin-top-5">Visitors linked to your account</h3>

        {{ govukTable({
          head: [
            {
              text: "Name"
            },
            {
              text: "Date of birth"
            },
            {
              text: "Can you book a visit for them?"
            }
          ],
          rows: visitorsTableRows
        }) }}
      {% else %}
        {{ govukWarningText({
          text: "No visitors are currently approved.",
          iconFallbackText: "Warning",
          attributes: { "data-test": "no-visitors" }
        }) }}
      {% endif %}

      {% if visitorRequestsTableRows | length %}
        <h2 class="govuk-heading-m" data-test="visitor-requests">Visitors awaiting review</h2>

        <p>Requests to link visitors are reviewed by the prison.</p>

        {{ govukTable({
          classes: "govuk-!-width-two-thirds",
          head: [
            {
              text: "Name"
            },
            {
              text: "Date of birth"
            }
          ],
          rows: visitorRequestsTableRows
        }) }}
      {% endif %}

      <h2 class="govuk-heading-m">Linking new visitors to your account</h2>

      <p>You can only book visits for people linked to your account.</p>
      <p>Visitors must be on the prisoner’s visitor list.</p>
      <p>We will respond to your request within 5 working days.</p>

      {{ govukButton({
        text: "Link a new visitor",
        href: paths.ADD_VISITOR.START,
        attributes: { "data-test": "link-a-visitor" },
        preventDoubleClick: true
      }) }} 


    </div>
  </div>
{% endblock %}
